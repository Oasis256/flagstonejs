/*
 FlagstoneJS v2.1.1
 (c) 2015 Depth Development. http://depthdev.com
 License: Apache 2.0
*/

function FLAGSTONE(t){var i=function(t){for(var i=[],e=document.querySelectorAll(t),s=0,n=e.length;n>s;s++)i[s]=e[s];return i.length>1?i:i[0]},e=t||{},s=e.area||"[flagstones]",n=i(s),o=e.margin||0===e.margin?e.margin:e.areaMargin||0===e.areaMargin?e.areaMargin:10,r=0,a=e.minWidth||280,d=e.maxColumns||1920,h=0,l=0,u=e.flagstones||"[flagstone]",c=i(u),f=e.margin||0===e.margin?e.margin:e.flagstonesMargin||0===e.flagstonesMargin?e.flagstonesMargin:10,m=r/l-f*(l+1)/l,g=[],b=e.direction?e.direction.toLowerCase():"left",p=e.random?(c.sort(function(){return.5-Math.random()}),!0):!1,x=e.spaceFrequency||.4,y=function(){for(var t=0,i=c.length;i>t;t++)Math.random()<x&&c.splice(t,0,!1)},v=e.space?(y(),!0):!1,T=e.duration/1e3||0,z=e.resizeDelay||0===e.resizeDelay?e.resizeDelay:250,M=e.square||!1;this.hide=function(){n.className=n.className+" flagstones-hidden"};var w,N,k,C=e.custom||function(){return!1},E=function(){for(var t=[l],i=0,e=g.length;e>i;i++){if(l>i)if(c[i]){var s=c[i].style.cssText.replace(/.*width\:\s?(\d+).+/,"$1");c[i].style.cssText="width:"+s+"px;"+(M?"height:"+s+"px;":"")+"top:"+o+"px;"+b+":"+(m*i+(i?f*i+o:o))+"px;",t[i]=g[i]+o,C(i,c[i])}else l>1&&(t[i]=m+o);else{var r=Math.min.apply(null,t),a=t.indexOf(r);if(c[i]){var s=c[i].style.cssText.replace(/.*width\:\s?(\d+).+/,"$1");c[i].style.cssText="width:"+s+"px;"+(M?"height:"+s+"px;":"")+"top:"+(r+f)+"px;"+b+":"+(m*a+(a?f*a+o:o))+"px;",t[a]+=g[i]+f,C(i,c[i])}else l>1&&(t[a]+=m+f)}n.style.height=(Math.max.apply(null,t)||g[0]+o)+o+"px"}setTimeout(function(){n.className=n.className.replace(/\s?flagstones\-hidden/,"")}.bind(this),0)};this.reset=function(){r=n.outerWidth||n.offsetWidth,a+(o?2*o:0)>r&&(r=a),h=Math.floor(r/a),l=h>d?d:h,m=r/l-(f*(l-1)+2*o)/l,g=[];for(var t=0,i=c.length;i>t;t++)c[t]&&(c[t].style.width=m+"px"),g.push(M||!c[t]?m:c[t].outerHeight||c[t].offsetHeight);E()}.bind(this),this.hardReset=function(){this.hide(),setTimeout(function(){c=i(u),p&&c.sort(function(){return.5-Math.random()}),v&&y(),this.reset()}.bind(this),0)}.bind(this);var L=function(){clearTimeout(w),clearTimeout(N),clearTimeout(k),w=setTimeout(this.reset.bind(this),z),N=setTimeout(this.reset.bind(this),1e3*T+z),k=setTimeout(this.reset.bind(this),2e3*T+z)}.bind(this);(function(){if(this.hide,!i("#flagstone-styles")){var t=s+"{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;position:relative;min-width:"+(a+2*f)+"px;}"+u+"{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;position:absolute;top:0px;"+b+":0px;}"+s+".flagstones-hidden{visibility:hidden;}"+s+"{-webkit-transition-duration:"+T+"s;-moz-transition-duration:"+T+"s;-ms-transition-duration:"+T+"s;-o-transition-duration:"+T+"s;transition-duration:"+T+"s;}"+u+"{-webkit-transition-duration:"+T+"s;-moz-transition-duration:"+T+"s;-ms-transition-duration:"+T+"s;-o-transition-duration:"+T+"s;transition-duration:"+T+"s;}",e=document.createElement("style");e.type="text/css",e.id="flagstone-styles",e.appendChild(document.createTextNode(t)),i("head").appendChild(e)}setTimeout(this.reset,0),addEventListener("load",L.bind(this)),addEventListener("resize",L.bind(this))}).bind(this)()}
