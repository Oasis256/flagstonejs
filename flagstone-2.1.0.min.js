/*
 FlagstoneJS v2.1.0
 (c) 2015 Clearwave Designs, LLC. http://clearwavedesigns.com
 License: Apache 2.0
*/

function FLAGSTONE(t){var i=function(t){for(var i=[],e=document.querySelectorAll(t),n=0,s=e.length;s>n;n++)i[n]=e[n];return i.length>1?i:i[0]},e=t||{},n=e.area||"[flagstones]",s=i(n),o=e.margin||0===e.margin?e.margin:e.areaMargin||0===e.areaMargin?e.areaMargin:10,r=0,a=e.minWidth||280,d=e.maxColumns||1920,h=0,l=0,u=e.flagstones||"[flagstone]",c=i(u),m=e.margin||0===e.margin?e.margin:e.flagstonesMargin||0===e.flagstonesMargin?e.flagstonesMargin:10,f=r/l-m*(l+1)/l,g=[],b=e.direction?e.direction.toLowerCase():"left",p=e.random?(c.sort(function(){return.5-Math.random()}),!0):!1,x=e.spaceFrequency||.4,y=function(){for(var t=0,i=c.length;i>t;t++)Math.random()<x&&c.splice(t,0,!1)},v=e.space?(y(),!0):!1,T=e.duration/1e3||0,z=e.resizeDelay||0===e.resizeDelay?e.resizeDelay:250,M=e.square||!1;this.hide=function(){s.className=s.className+" flagstones-hidden"};var w,N,k,C=e.custom||function(){return!1},E=function(){for(var t=[l],i=0,e=g.length;e>i;i++){if(l>i)if(c[i]){var n=c[i].style.cssText.replace(/.*width\:\s?(\d+).+/,"$1");c[i].style.cssText="width:"+n+"px;"+(M?"height:"+n+"px;":"")+"top:"+o+"px;"+b+":"+(f*i+(i?m*i+o:o))+"px;",t[i]=g[i]+o,C(i,c[i])}else l>1&&(t[i]=f+o);else{var r=Math.min.apply(null,t),a=t.indexOf(r);if(c[i]){var n=c[i].style.cssText.replace(/.*width\:\s?(\d+).+/,"$1");c[i].style.cssText="width:"+n+"px;"+(M?"height:"+n+"px;":"")+"top:"+(r+m)+"px;"+b+":"+(f*a+(a?m*a+o:o))+"px;",t[a]+=g[i]+m,C(i,c[i])}else l>1&&(t[a]+=f+m)}s.style.height=(Math.max.apply(null,t)||g[0]+o)+o+"px"}setTimeout(function(){s.className=s.className.replace(/\s?flagstones\-hidden/,"")}.bind(this),0)};this.reset=function(){r=s.outerWidth||s.offsetWidth,a+(o?2*o:0)>r&&(r=a),h=Math.floor(r/a),l=h>d?d:h,f=r/l-(m*(l-1)+2*o)/l,g=[];for(var t=0,i=c.length;i>t;t++)c[t]&&(c[t].style.width=f+"px"),g.push(M||!c[t]?f:c[t].outerHeight||c[t].offsetHeight);E()}.bind(this),this.hardReset=function(){this.hide(),setTimeout(function(){c=i(u),p&&c.sort(function(){return.5-Math.random()}),v&&y(),this.reset()}.bind(this),0)}.bind(this);var L=function(){clearTimeout(w),clearTimeout(N),clearTimeout(k),w=setTimeout(this.reset.bind(this),z),N=setTimeout(this.reset.bind(this),1e3*T+z),k=setTimeout(this.reset.bind(this),2e3*T+z)}.bind(this);(function(){this.hide;var t=n+"{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;position:relative;min-width:"+(a+2*m)+"px;}"+u+"{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;position:absolute;top:0px;"+b+":0px;}"+n+".flagstones-hidden{visibility:hidden;}</style>"+n+"{-webkit-transition-duration:"+T+"s;-moz-transition-duration:"+T+"s;-ms-transition-duration:"+T+"s;-o-transition-duration:"+T+"s;transition-duration:"+T+"s;}"+u+"{-webkit-transition-duration:"+T+"s;-moz-transition-duration:"+T+"s;-ms-transition-duration:"+T+"s;-o-transition-duration:"+T+"s;transition-duration:"+T+"s;}",e=document.createElement("style");e.type="text/css",e.appendChild(document.createTextNode(t)),i("head").appendChild(e),setTimeout(this.reset,0),addEventListener("load",L.bind(this)),addEventListener("resize",L.bind(this))}).bind(this)()}
