/*
 Copyright 2014 by CLEARWAVE DESIGNS, LLC.
 
 Licensed under the Apache License, Version 2.0
 http://www.apache.org/licenses/LICENSE-2.0
 
 Author:        Adam Carson
 Website:       http://clearwavedesigns.com
 Dependencies:  jquery.js (1.8.3+)
 
 Name(s):       FlagstoneJS (jQuery dependent)
 Slogan:        "Responsive tiling."
 Description:   Responsively tiles HTML elements left to right, top to bottom, and where there's the most room.
*/

var FLAGSTONE=function(t){var i=this;this.area=t.area,this.areaWidth=this.area.outerWidth(),this.areaHeight=this.area.outerHeight(),this.minWidth=t.minWidth,this.columns=Math.floor(this.areaWidth/this.minWidth),this.margin=t.margin,this.flagstones=t.flagstones,this.flagstoneHeights=[],this.flagstoneWidth=this.areaWidth/this.columns-this.margin*(this.columns-1)/this.columns,this.init=function(){this.area.css("position","relative"),this.flagstones.each(function(){var t=$(this);t.css({position:"absolute",top:"0px",left:"0px",width:i.flagstoneWidth+"px","-webkit-transition-duration":"1s","-moz-transition-duration":"1s","-ms-transition-duration":"1s","-o-transition-duration":"1s","ransition-duration":"1s"}),i.flagstoneHeights.push(t.outerHeight())})},this.init(),this.run=function(){for(var t=new Array(this.columns),i=0,s=this.flagstoneHeights.length;s>i;i++){if(i>=this.columns){var e=Math.min.apply(null,t),a=t.indexOf(e);this.flagstones.eq(i).css({top:e+this.margin+"px",left:(this.flagstoneWidth+this.margin)*a+"px"}),t[a]+=this.flagstoneHeights[i]+this.margin}else for(var h=0,n=this.columns;n>h;h++)this.flagstones.eq(h).css({top:"0px",left:(this.flagstoneWidth+this.margin)*h+"px"}),t[h]=this.flagstoneHeights[h];this.area.css("height",Math.max.apply(null,t)+"px")}},this.run(),this.resetDelay1,this.resetDelay2,this.reset=function(){for(i.areaWidth=i.area.outerWidth(),i.columns=Math.floor(i.areaWidth/i.minWidth),i.flagstoneWidth=i.areaWidth/i.columns-i.margin*(i.columns-1)/i.columns;i.flagstoneHeights.length>0;)i.flagstoneHeights.pop();i.flagstones.each(function(){var t=$(this);t.css("width",i.flagstoneWidth+"px"),i.flagstoneHeights.push(t.outerHeight())}),i.run()},$(window).on("resize",function(){clearTimeout(i.resetDelay1),clearTimeout(i.resetDelay2),i.resetDelay1=setTimeout(i.reset,100),i.resetDelay2=setTimeout(i.reset,1100)})};
